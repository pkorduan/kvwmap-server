#!/bin/bash

install_service() {

	echo "Installation von Service geoserver in Netzwerk '${NETWORK_NAME}'"
	echo "optional neuer Service-Name (Default 'geoserver'): "
	read SERVICE_NAME

  echo "Servername: "
  read HOSTNAME

	if [ -z "$SERVICE_NAME" ]; then
		SERVICE_NAME=geoserver
	fi

	echo "Service-Name: ${SERVICE_NAME}"

	SERVICE_PATH=${USER_DIR}/networks/${NETWORK_NAME}/services/${SERVICE_NAME}

	if [ -d "$SERVICE_PATH" ]; then
		echo "Der Service existiert in dem Netzwerk bereits. Starten Sie erneut und w√§hlen Sie einen anderen Namen!"
		echo "${SERVICE_PATH} ist bereits vorhanden!"
		return 1
	fi

	mkdir ${SERVICE_PATH}
	cp    ${USER_DIR}/kvwmap-server/service-templates/geoserver/compose-template.yml ${SERVICE_PATH}/
	mkdir ${SERVICE_PATH}/data_dir
  chown gisadmin.gisadmin ${SERVICE_PATH}/data_dir
	mkdir ${SERVICE_PATH}/logs
  chown gisadmin.gisadmin ${SERVICE_PATH}/logs
  # Link auf die Logdatei von Geoserver im logs Verzeichnis von Tomcat
  ln -d ${SERVICE_PATH}/data_dir/logs/geoserver.log ${SERVICE_PATH}/logs/geoserver.log

	echo "Installation von ${SERVICE_NAME} in ${NETWORK_NAME} beendet."
}
